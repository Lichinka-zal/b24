# b24
Bitrix 24 connector for MS Power BI. Получает информацию из облачного и коробочного битрикс.

## Описание параметров

Параметр | Описание
---------|--------
chain | пакет запросов к функции batch https://dev.1c-bitrix.ru/rest_help/general/batch.php
connection | строка подключения к вебхуку (см. ниже, где её взять)
id | список идентификаторов (виде списка или текста) для автоматического создания пакета запросов типа get

## 

Тестировал только на запросах get и list

Справочник по API Битрикс 24 https://dev.1c-bitrix.ru/rest_help/index.php

У пакетных запросов немного особенный синтаксис: настройка фильтров, идентификаторов и списка возвращаемых полей происходит в GET-параметрах

Примеры вызовов:
* b24("department.get") // список подразделений
* b24("crm.deal.list?filter[>DATE_CREATE]=2019-03-15T00:00:00&filter[<DATE_CREATE]=2019-03-18T00:00:00") // список сделок в промежутке дат с 15.03.2019 по 18.03.2019
* b24(Text.Format("crm.lead.list?filter[>DATE_CREATE]=#[from]&filter[<DATE_CREATE]=#[to]&filter[SOURCE_ID]=OTHER&select[]=ID&select[]=TITLE", [from = DateTime.ToText(begin,"yyyy-MM-ddT00:00:00"), to = DateTime.ToText(today,"yyyy-MM-ddT00:00:00")])) // список лидов в промежутке дат, созданных из источника OTHER, с возвратом только полей ID и TITLE
* b24("crm.dealcategory.stage.list?id=5") // список этапов 5-й воронки
* b24("crm.deal.get?id=",null,{1529,2227}) // пакетное получение сделок с идентификаторами 1529 и 2227
* b24("voximplant.statistic.get",null,false) // возвращает список из первых 50 значений


## Как создать строку подключения
Убедитесь, что у вас достаточно прав в Битрикс 24.
1. Залогиниться в Б24
2. Пройти в "Приложения" > "Вебхуки" https://prnt.sc/q52kpf
3. Нажать "Добавить вебхук" > "Входящий вебхук" http://prntscr.com/q52n3i
4. Придумать название, выбрать права доступа (их можно потом отредактировать) http://prntscr.com/q52o0n
5. Сохранить и скопировать строку подключения http://prntscr.com/q52r32

Параметры подключения можно задать в теле коннектора, чтобы не указывать каждый раз. Смотрите комментарии в коде
